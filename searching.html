<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Package Searching &#8212; Common Package Specification v0.8.1</title>
    
    <link rel="stylesheet" href="_static/cps.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.8.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Supplemental Schema" href="schema-supplement.html" />
    <link rel="prev" title="Package Configurations" href="configurations.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="schema-supplement.html" title="Supplemental Schema"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configurations.html" title="Package Configurations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Common Package Specification v0.8.1</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="package-searching">
<h1>Package Searching<a class="headerlink" href="#package-searching" title="Permalink to this headline">¶</a></h1>
<p>Tools shall locate a package by searching for a file <code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">.cps</span></code> or <code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">-</span></code><code class="code glob docutils literal"><span class="pre">*</span></code><code class="code path docutils literal"><span class="pre">.cps</span></code> (where the asterisk (<code class="docutils literal"><span class="pre">*</span></code>) is one or more characters excluding colon (<code class="docutils literal"><span class="pre">:</span></code>) and at-sign (<code class="docutils literal"><span class="pre">&#64;</span></code>), allowing <code class="docutils literal"><span class="pre">.cps</span></code> files to supply a version number as part of their name so that multiple versions may be co-installed) in the following paths:</p>
<ul class="simple">
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/cps/</span></code> <span class="applies-to">(Windows)</span></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">.framework/Resources/CPS/</span></code> <span class="applies-to">(MacOS)</span></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">.framework/Versions/</span></code><code class="code glob docutils literal"><span class="pre">*</span></code><code class="code path docutils literal"><span class="pre">/Resources/CPS/</span></code> <span class="applies-to">(MacOS)</span></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">.app/Contents/Resources/CPS/</span></code> <span class="applies-to">(MacOS)</span></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">libdir</span></code><code class="code path docutils literal"><span class="pre">/cps/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code glob docutils literal"><span class="pre">*</span></code><code class="code path docutils literal"><span class="pre">/</span></code></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">libdir</span></code><code class="code path docutils literal"><span class="pre">/cps/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">/</span></code></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">libdir</span></code><code class="code path docutils literal"><span class="pre">/cps/</span></code></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/share/cps/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code glob docutils literal"><span class="pre">*</span></code><code class="code path docutils literal"><span class="pre">/</span></code></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/share/cps/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">/</span></code></li>
<li><code class="code var docutils literal"><span class="pre">prefix</span></code><code class="code path docutils literal"><span class="pre">/share/cps/</span></code></li>
</ul>
<p>The placeholder <code class="code var docutils literal"><span class="pre">name</span></code> shall represent the name of the package to be located, and shall include both the proper case name, and the name converted to lower case. The placeholder <code class="code var docutils literal"><span class="pre">libdir</span></code> shall be the platform defined directories, sans root prefix, in which matching architecture and/or architecture-neutral libraries reside (e.g. <code class="code path docutils literal"><span class="pre">lib</span></code>, <code class="code path docutils literal"><span class="pre">lib32</span></code>, <code class="code path docutils literal"><span class="pre">lib64</span></code>, <code class="code path docutils literal"><span class="pre">lib/i386-linux-gnu</span></code>...). The placeholder <code class="code var docutils literal"><span class="pre">prefix</span></code> shall represent one of the set of default install prefixes to be searched, which shall include, at minimum and in order, the set of paths (separated by <code class="code path docutils literal"><span class="pre">;</span></code> on Windows, <code class="code path docutils literal"><span class="pre">:</span></code> otherwise) in the environment variable <code class="code env docutils literal"><span class="pre">CPS_PATH</span></code>, <code class="code path docutils literal"><span class="pre">/usr/local</span></code>, and <code class="code path docutils literal"><span class="pre">/usr</span></code>. In addition, for all such package-neutral prefixes <code class="code var docutils literal"><span class="pre">prefix-root</span></code>, the package-specific prefix <code class="code var docutils literal"><span class="pre">prefix-root</span></code><code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code> shall also be considered.
The complete list of search paths, above, shall be considered in the order specified above, for each prefix, before the next prefix is searched. Package-specific prefixes shall be searched before package-neutral prefixes.</p>
<p>It is recommended that tools should also provide a mechanism for specifying the path to a specific CPS which may be used to override the default search, or to provide the location of a package which is not installed to any of the standard search paths.</p>
<p>When a candidate <code class="docutils literal"><span class="pre">.cps</span></code> file is found, the tool shall inspect the package&#8217;s <a class="reference internal" href="schema.html#platform"><span class="std std-ref">Platform</span></a>. If the package&#8217;s platform does not match the target platform, the tool should ignore the <code class="docutils literal"><span class="pre">.cps</span></code> and continue the search. This allows for the installation of packages for different platforms (e.g. 32- and 64-bit builds) on a single machine. (Note that it is up to the tool to determine what constitutes a matching platform.) Similarly, if the package&#8217;s version does not satisfy the required version as specified by the user, the tool should continue searching. (In both cases, the tool may wish to make note of the incompatible packages, and the reason for rejection.)</p>
<div class="section" id="prefix-determination">
<h2>Prefix Determination<a class="headerlink" href="#prefix-determination" title="Permalink to this headline">¶</a></h2>
<p>In order to determine the package prefix, which may appear in various attributes as <code class="docutils literal"><span class="pre">&#64;prefix&#64;</span></code>, it is necessary to determine the effective prefix from the canonical location of the <code class="docutils literal"><span class="pre">.cps</span></code> file. This can be accomplished in three ways:</p>
<ul class="simple">
<li>If the package specifies a <code class="code attribute docutils literal"><span class="pre">Cps-Path</span></code>, that value shall be used.</li>
<li>Otherwise, if the tool has just completed a search for the <code class="docutils literal"><span class="pre">.cps</span></code>, as described above, the prefix is known from the path which was searched.</li>
<li>Otherwise, the prefix shall be deduced as follows:<ul>
<li>The path is initially taken to be the directory portion (i.e. without file name) of the absolute path to the <code class="docutils literal"><span class="pre">.cps</span></code> file.</li>
<li><span class="applies-to">(MacOS)</span> If the tail-portion matches <code class="code path docutils literal"><span class="pre">/Resources/</span></code> or <code class="code path docutils literal"><span class="pre">/Resources/CPS/</span></code>, then:<ul>
<li>The matching portion is removed.</li>
<li>If the tail-portion of the remaining path matches <code class="code path docutils literal"><span class="pre">/Versions/</span></code><code class="code glob docutils literal"><span class="pre">*</span></code><code class="code path docutils literal"><span class="pre">/</span></code>, that portion is removed.</li>
<li>If the tail-portion of the remaining path matches <code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">.framework/</span></code> or <code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">.app/Contents/</span></code>, that portion is removed.</li>
</ul>
</li>
<li>Otherwise:<ul>
<li>If the tail-portion of the path matches any of <code class="code path docutils literal"><span class="pre">/cps/</span></code>, <code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">/cps/</span></code> or <code class="code path docutils literal"><span class="pre">/cps/</span></code><code class="code var docutils literal"><span class="pre">name</span></code><code class="code path docutils literal"><span class="pre">/</span></code>, the longest such matching portion is removed.</li>
<li>If the tail-portion of the remaining path matches any of <code class="code path docutils literal"><span class="pre">/</span></code><code class="code var docutils literal"><span class="pre">libdir</span></code><code class="code path docutils literal"><span class="pre">/</span></code> or <code class="code path docutils literal"><span class="pre">/share/</span></code>, that portion is removed.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Process</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="schema.html">Package Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Compiler and Linker Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Component Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurations.html">Package Configurations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Package Searching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prefix-determination">Prefix Determination</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="schema-supplement.html">Supplemental Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="recommendations.html">Usage and Implementation Recommendations</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample.html">Sample CPS File</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="configurations.html"
                        title="previous chapter">Package Configurations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="schema-supplement.html"
                        title="next chapter">Supplemental Schema</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/searching.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="schema-supplement.html" title="Supplemental Schema"
             >next</a> |</li>
        <li class="right" >
          <a href="configurations.html" title="Package Configurations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Common Package Specification v0.8.1</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Matthew Woehlke.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>